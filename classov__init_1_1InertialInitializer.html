<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ov_init::InertialInitializer class | OpenVINS</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600&amp;subset=latin-ext" />
  <link rel="stylesheet" href="m-udel+documentation.compiled.css" />
  <link rel="stylesheet" href="custom.css" />
  <link rel="icon" href="favicon-light.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#2f73a3" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">OpenVINS</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Pages</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="namespaceov__core.html">ov_core</a></li>
            <li><a href="namespaceov__type.html">ov_type</a></li>
            <li><a href="namespaceov__msckf.html">ov_msckf</a></li>
            <li><a href="namespaceov__init.html">ov_init</a></li>
            <li><a href="namespaceov__eval.html">ov_eval</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="8">
            <li><a href="https://github.com/rpng/open_vins/">GitHub</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespaceov__init.html">ov_init</a>::<wbr/></span>InertialInitializer <span class="m-thin">class</span>
        </h1>
        <p>Initializer for visual-inertial system.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
                <li><a href="#pro-attribs">Protected variables</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p>This will try to do both dynamic and state initialization of the state. The user can request to wait for a jump in our IMU readings (i.e. device is picked up) or to initialize as soon as possible. For state initialization, the user needs to specify the calibration beforehand, otherwise dynamic is always used.</p><p>The logic is as follows:</p><ol><li>Try to perform dynamic initialization of state elements.</li><li>If this fails and we have calibration then we can try to do static initialization</li><li>If the unit is stationary and we are waiting for a jerk, just return, otherwise initialize the state!</li></ol><p>The dynamic system is based on an implementation and extension of the work <a href="https://ieeexplore.ieee.org/document/6386235">Estimator initialization in vision-aided inertial navigation with unknown camera-IMU calibration</a> <a href="citelist.html#CITEREF_Dong2012IROS" class="m-doc">[4]</a> which solves the initialization problem by first creating a linear system for recovering the camera to IMU rotation, then for velocity, gravity, and feature positions, and finally a full optimization to allow for covariance recovery.</p>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper"><a href="#ab53c9effb332d8259cd04e06ab26ce5f" class="m-doc">InertialInitializer</a>(</span><span class="m-doc-wrap"><a href="structov__init_1_1InertialInitializerOptions.html" class="m-doc">InertialInitializerOptions</a>&amp; params_,
              std::shared_ptr&lt;<a href="classov__core_1_1FeatureDatabase.html" class="m-doc">ov_core::<wbr />FeatureDatabase</a>&gt; db) <span class="m-label m-flat m-info">explicit</span> </span>
            </dt>
            <dd>Default constructor.</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-doc">
            <dt>
              <span class="m-doc-wrap-bumper">void <a href="#a56f92fa249d304e96df389002f3b15e9" class="m-doc">feed_imu</a>(</span><span class="m-doc-wrap">const <a href="structov__core_1_1ImuData.html" class="m-doc">ov_core::<wbr />ImuData</a>&amp; message)</span>
            </dt>
            <dd>Feed function for inertial data.</dd>
            <dt>
              <span class="m-doc-wrap-bumper">auto <a href="#aa2288d134687ccf1b7ee85ddcf982991" class="m-doc">initialize</a>(</span><span class="m-doc-wrap">double&amp; timestamp,
              Eigen::MatrixXd&amp; covariance,
              std::vector&lt;std::shared_ptr&lt;<a href="classov__type_1_1Type.html" class="m-doc">ov_type::<wbr />Type</a>&gt;&gt;&amp; order,
              std::shared_ptr&lt;<a href="classov__type_1_1IMU.html" class="m-doc">ov_type::<wbr />IMU</a>&gt; t_imu,
              bool wait_for_jerk = true) -&gt; bool</span>
            </dt>
            <dd>Try to get the initialized system.</dd>
          </dl>
        </section>
        <section id="pro-attribs">
          <h2><a href="#pro-attribs">Protected variables</a></h2>
          <dl class="m-doc">
            <dt id="aa2a83ab908985ccb9f89dd6613fb203c">
              <a href="structov__init_1_1InertialInitializerOptions.html" class="m-doc">InertialInitializerOptions</a> <a href="#aa2a83ab908985ccb9f89dd6613fb203c" class="m-doc-self">params</a>
            </dt>
            <dd>Initialization parameters.</dd>
            <dt id="a3968041a4da5cf43774845bd1782707d">
              std::shared_ptr&lt;<a href="classov__core_1_1FeatureDatabase.html" class="m-doc">ov_core::<wbr />FeatureDatabase</a>&gt; <a href="#a3968041a4da5cf43774845bd1782707d" class="m-doc-self">_db</a>
            </dt>
            <dd>Feature tracker database with all features in it.</dd>
            <dt id="a41bba4e8e0bb529ca90bd80a0cbe77d4">
              std::shared_ptr&lt;std::vector&lt;<a href="structov__core_1_1ImuData.html" class="m-doc">ov_core::<wbr />ImuData</a>&gt;&gt; <a href="#a41bba4e8e0bb529ca90bd80a0cbe77d4" class="m-doc-self">imu_data</a>
            </dt>
            <dd>Our history of IMU messages (time, angular, linear)</dd>
            <dt id="a89f3e90f16c4c42407696a11701f6db3">
              std::shared_ptr&lt;<a href="classov__init_1_1StaticInitializer.html" class="m-doc">StaticInitializer</a>&gt; <a href="#a89f3e90f16c4c42407696a11701f6db3" class="m-doc-self">init_static</a>
            </dt>
            <dd>Static initialization helper class.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-doc-details" id="ab53c9effb332d8259cd04e06ab26ce5f"><div>
            <h3>
              <span class="m-doc-wrap-bumper"> ov_init::<wbr />InertialInitializer::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#ab53c9effb332d8259cd04e06ab26ce5f" class="m-doc-self">InertialInitializer</a>(</span><span class="m-doc-wrap"><a href="structov__init_1_1InertialInitializerOptions.html" class="m-doc">InertialInitializerOptions</a>&amp; params_,
              std::shared_ptr&lt;<a href="classov__core_1_1FeatureDatabase.html" class="m-doc">ov_core::<wbr />FeatureDatabase</a>&gt; db) <span class="m-label m-info">explicit</span> </span></span>
            </h3>
            <p>Default constructor.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">params_</td>
                  <td>Parameters loaded from either ROS or CMDLINE</td>
                </tr>
                <tr>
                  <td>db</td>
                  <td>Feature tracker database with all features in it</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="a56f92fa249d304e96df389002f3b15e9"><div>
            <h3>
              <span class="m-doc-wrap-bumper">void ov_init::<wbr />InertialInitializer::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#a56f92fa249d304e96df389002f3b15e9" class="m-doc-self">feed_imu</a>(</span><span class="m-doc-wrap">const <a href="structov__core_1_1ImuData.html" class="m-doc">ov_core::<wbr />ImuData</a>&amp; message)</span></span>
            </h3>
            <p>Feed function for inertial data.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">message</td>
                  <td>Contains our timestamp and inertial information</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-doc-details" id="aa2288d134687ccf1b7ee85ddcf982991"><div>
            <h3>
              <span class="m-doc-wrap-bumper">bool ov_init::<wbr />InertialInitializer::<wbr /></span><span class="m-doc-wrap"><span class="m-doc-wrap-bumper"><a href="#aa2288d134687ccf1b7ee85ddcf982991" class="m-doc-self">initialize</a>(</span><span class="m-doc-wrap">double&amp; timestamp,
              Eigen::MatrixXd&amp; covariance,
              std::vector&lt;std::shared_ptr&lt;<a href="classov__type_1_1Type.html" class="m-doc">ov_type::<wbr />Type</a>&gt;&gt;&amp; order,
              std::shared_ptr&lt;<a href="classov__type_1_1IMU.html" class="m-doc">ov_type::<wbr />IMU</a>&gt; t_imu,
              bool wait_for_jerk = true)</span></span>
            </h3>
            <p>Try to get the initialized system.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">timestamp&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Timestamp we have initialized the state at</td>
                </tr>
                <tr>
                  <td>covariance&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Calculated covariance of the returned state</td>
                </tr>
                <tr>
                  <td>order&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Order of the covariance matrix</td>
                </tr>
                <tr>
                  <td>t_imu&nbsp;<span class="m-label m-flat m-warning">out</span></td>
                  <td>Our imu type (need to have correct ids)</td>
                </tr>
                <tr>
                  <td>wait_for_jerk</td>
                  <td>If true we will wait for a &quot;jerk&quot;</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>True if we have successfully initialized our system</td>
                </tr>
              </tfoot>
            </table>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.20 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
